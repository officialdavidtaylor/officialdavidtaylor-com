---
import { getCollection } from 'astro:content';
import Root from 'layouts/Root.astro';

const records = await getCollection('records').then((records) =>
  // sort by artist name (omitting "The" prefix)
  records.sort((recordA, recordB) => {
    let artistA = recordA.data.artist;
    if (artistA.toLocaleLowerCase().startsWith('the ')) {
      artistA = artistA.substring(4);
    }

    let artistB = recordB.data.artist;
    if (artistB.toLocaleLowerCase().startsWith('the ')) {
      artistB = artistB.substring(4);
    }
    return artistA.localeCompare(artistB);
  })
);
---

<Root title="My Record Collection">
  <div class="mx-auto max-w-4xl pt-[20%] font-serif">
    <h1 class="pb-14 text-5xl md:text-center">My Record Collection</h1>
    <div class="pb-4 text-xl">
      <p>My partner gifted me a record player for a recent birthday.</p>
      <br />
      <p>
        Since then I've been building my collection one LP at a time, with much
        help from beloved family and friends.
      </p>
      <br />
      <p>This is the collection thus far:</p>
    </div>
  </div>
  <div
    class="-mx-4 mt-8 mb-4 flex max-w-4xl flex-col gap-2 bg-neutral-100 p-2 py-3 font-sans sm:mx-auto sm:gap-2 sm:rounded-xl sm:p-2"
  >
    {
      records.map((record) => (
        <div class="flex items-center gap-4 rounded-lg border-2 border-transparent p-2 transition-all ease-in-out select-none open:border-2 open:border-neutral-400">
          <img
            src={record.data.cover.src}
            alt=""
            role="presentation"
            class="max-w-20 rounded-sm shadow-sm"
          />
          <div class="h-full">
            <p class="text-2xl leading-6">{record.data.title}</p>
            <p class="font-serif text-lg text-neutral-400">
              {record.data.artist}
            </p>
          </div>
        </div>
      ))
    }
  </div>
</Root>
